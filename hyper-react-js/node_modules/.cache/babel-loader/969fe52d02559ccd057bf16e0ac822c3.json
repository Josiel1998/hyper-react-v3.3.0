{"ast":null,"code":"import _objectSpread from\"/Users/josieldelgadillo/GitHub_M1/GitHub/hyper-react-v3.3.0/hyper-react-js/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _createForOfIteratorHelper from\"/Users/josieldelgadillo/GitHub_M1/GitHub/hyper-react-v3.3.0/hyper-react-js/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _createClass from\"/Users/josieldelgadillo/GitHub_M1/GitHub/hyper-react-v3.3.0/hyper-react-js/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _classCallCheck from\"/Users/josieldelgadillo/GitHub_M1/GitHub/hyper-react-v3.3.0/hyper-react-js/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import jwtDecode from'jwt-decode';import axios from'axios';import config from'../../config';// content type\naxios.defaults.headers.post['Content-Type']='application/json';axios.defaults.baseURL=config.API_URL;// intercepting to capture errors\naxios.interceptors.response.use(function(response){return response;},function(error){// Any status codes that falls outside the range of 2xx cause this function to trigger\nvar message;if(error&&error.response&&error.response.status===404){// window.location.href = '/not-found';\n}else if(error&&error.response&&error.response.status===403){window.location.href='/access-denied';}else{switch(error.response.status){case 401:message='Invalid credentials';break;case 403:message='Access Forbidden';break;case 404:message='Sorry! the data you are looking for could not be found';break;default:{message=error.response&&error.response.data?error.response.data['message']:error.message||error;}}return Promise.reject(message);}});var AUTH_SESSION_KEY='hyper_user';/**\n * Sets the default authorization\n * @param {*} token\n */var setAuthorization=function setAuthorization(token){if(token)axios.defaults.headers.common['Authorization']='JWT '+token;else delete axios.defaults.headers.common['Authorization'];};var getUserFromSession=function getUserFromSession(){var user=sessionStorage.getItem(AUTH_SESSION_KEY);return user?typeof user=='object'?user:JSON.parse(user):null;};var APICore=/*#__PURE__*/_createClass(function APICore(){var _this=this;_classCallCheck(this,APICore);this.get=function(url,params){var response;if(params){var queryString=params?Object.keys(params).map(function(key){return key+'='+params[key];}).join('&'):'';response=axios.get(\"\".concat(url,\"?\").concat(queryString),params);}else{response=axios.get(\"\".concat(url),params);}return response;};this.getFile=function(url,params){var response;if(params){var queryString=params?Object.keys(params).map(function(key){return key+'='+params[key];}).join('&'):'';response=axios.get(\"\".concat(url,\"?\").concat(queryString),{responseType:'blob'});}else{response=axios.get(\"\".concat(url),{responseType:'blob'});}return response;};this.getMultiple=function(urls,params){var reqs=[];var queryString='';if(params){queryString=params?Object.keys(params).map(function(key){return key+'='+params[key];}).join('&'):'';}var _iterator=_createForOfIteratorHelper(urls),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var url=_step.value;reqs.push(axios.get(\"\".concat(url,\"?\").concat(queryString)));}}catch(err){_iterator.e(err);}finally{_iterator.f();}return axios.all(reqs);};this.create=function(url,data){return axios.post(url,data);};this.updatePatch=function(url,data){return axios.patch(url,data);};this.update=function(url,data){return axios.put(url,data);};this.delete=function(url){return axios.delete(url);};this.createWithFile=function(url,data){var formData=new FormData();for(var k in data){formData.append(k,data[k]);}var config={headers:_objectSpread(_objectSpread({},axios.defaults.headers),{},{'content-type':'multipart/form-data'})};return axios.post(url,formData,config);};this.updateWithFile=function(url,data){var formData=new FormData();for(var k in data){formData.append(k,data[k]);}var config={headers:_objectSpread(_objectSpread({},axios.defaults.headers),{},{'content-type':'multipart/form-data'})};return axios.patch(url,formData,config);};this.isUserAuthenticated=function(){var user=_this.getLoggedInUser();if(!user||user&&!user.token){return false;}var decoded=jwtDecode(user.token);var currentTime=Date.now()/1000;if(decoded.exp<currentTime){console.warn('access token expired');return false;}else{return true;}};this.setLoggedInUser=function(session){if(session)sessionStorage.setItem(AUTH_SESSION_KEY,JSON.stringify(session));else{sessionStorage.removeItem(AUTH_SESSION_KEY);}};this.getLoggedInUser=function(){return getUserFromSession();};this.setUserInSession=function(modifiedUser){var userInfo=sessionStorage.getItem(AUTH_SESSION_KEY);if(userInfo){var _JSON$parse=JSON.parse(userInfo),token=_JSON$parse.token,_user=_JSON$parse.user;_this.setLoggedInUser(_objectSpread(_objectSpread({token:token},_user),modifiedUser));}};});/*\nCheck if token available in session\n*/var user=getUserFromSession();if(user){var token=user.token;if(token){setAuthorization(token);}}export{APICore,setAuthorization};","map":{"version":3,"names":["jwtDecode","axios","config","defaults","headers","post","baseURL","API_URL","interceptors","response","use","error","message","status","window","location","href","data","Promise","reject","AUTH_SESSION_KEY","setAuthorization","token","common","getUserFromSession","user","sessionStorage","getItem","JSON","parse","APICore","get","url","params","queryString","Object","keys","map","key","join","getFile","responseType","getMultiple","urls","reqs","push","all","create","updatePatch","patch","update","put","delete","createWithFile","formData","FormData","k","append","updateWithFile","isUserAuthenticated","getLoggedInUser","decoded","currentTime","Date","now","exp","console","warn","setLoggedInUser","session","setItem","stringify","removeItem","setUserInSession","modifiedUser","userInfo"],"sources":["/Users/josieldelgadillo/GitHub_M1/GitHub/hyper-react-v3.3.0/hyper-react-js/src/helpers/api/apiCore.js"],"sourcesContent":["import jwtDecode from 'jwt-decode';\nimport axios from 'axios';\n\nimport config from '../../config';\n\n// content type\naxios.defaults.headers.post['Content-Type'] = 'application/json';\naxios.defaults.baseURL = config.API_URL;\n\n// intercepting to capture errors\naxios.interceptors.response.use(\n    (response) => {\n        return response;\n    },\n    (error) => {\n        // Any status codes that falls outside the range of 2xx cause this function to trigger\n        let message;\n\n        if (error && error.response && error.response.status === 404) {\n            // window.location.href = '/not-found';\n        } else if (error && error.response && error.response.status === 403) {\n            window.location.href = '/access-denied';\n        } else {\n            switch (error.response.status) {\n                case 401:\n                    message = 'Invalid credentials';\n                    break;\n                case 403:\n                    message = 'Access Forbidden';\n                    break;\n                case 404:\n                    message = 'Sorry! the data you are looking for could not be found';\n                    break;\n                default: {\n                    message =\n                        error.response && error.response.data ? error.response.data['message'] : error.message || error;\n                }\n            }\n            return Promise.reject(message);\n        }\n    }\n);\n\nconst AUTH_SESSION_KEY = 'hyper_user';\n\n/**\n * Sets the default authorization\n * @param {*} token\n */\nconst setAuthorization = (token) => {\n    if (token) axios.defaults.headers.common['Authorization'] = 'JWT ' + token;\n    else delete axios.defaults.headers.common['Authorization'];\n};\n\nconst getUserFromSession = () => {\n    const user = sessionStorage.getItem(AUTH_SESSION_KEY);\n    return user ? (typeof user == 'object' ? user : JSON.parse(user)) : null;\n};\nclass APICore {\n    /**\n     * Fetches data from given url\n     */\n    get = (url, params) => {\n        let response;\n        if (params) {\n            var queryString = params\n                ? Object.keys(params)\n                      .map((key) => key + '=' + params[key])\n                      .join('&')\n                : '';\n            response = axios.get(`${url}?${queryString}`, params);\n        } else {\n            response = axios.get(`${url}`, params);\n        }\n        return response;\n    };\n\n    getFile = (url, params) => {\n        let response;\n        if (params) {\n            var queryString = params\n                ? Object.keys(params)\n                      .map((key) => key + '=' + params[key])\n                      .join('&')\n                : '';\n            response = axios.get(`${url}?${queryString}`, { responseType: 'blob' });\n        } else {\n            response = axios.get(`${url}`, { responseType: 'blob' });\n        }\n        return response;\n    };\n\n    getMultiple = (urls, params) => {\n        const reqs = [];\n        let queryString = '';\n        if (params) {\n            queryString = params\n                ? Object.keys(params)\n                      .map((key) => key + '=' + params[key])\n                      .join('&')\n                : '';\n        }\n\n        for (const url of urls) {\n            reqs.push(axios.get(`${url}?${queryString}`));\n        }\n        return axios.all(reqs);\n    };\n\n    /**\n     * post given data to url\n     */\n    create = (url, data) => {\n        return axios.post(url, data);\n    };\n\n    /**\n     * Updates patch data\n     */\n    updatePatch = (url, data) => {\n        return axios.patch(url, data);\n    };\n\n    /**\n     * Updates data\n     */\n    update = (url, data) => {\n        return axios.put(url, data);\n    };\n\n    /**\n     * Deletes data\n     */\n    delete = (url) => {\n        return axios.delete(url);\n    };\n\n    /**\n     * post given data to url with file\n     */\n    createWithFile = (url, data) => {\n        const formData = new FormData();\n        for (const k in data) {\n            formData.append(k, data[k]);\n        }\n\n        const config = {\n            headers: {\n                ...axios.defaults.headers,\n                'content-type': 'multipart/form-data',\n            },\n        };\n        return axios.post(url, formData, config);\n    };\n\n    /**\n     * post given data to url with file\n     */\n    updateWithFile = (url, data) => {\n        const formData = new FormData();\n        for (const k in data) {\n            formData.append(k, data[k]);\n        }\n\n        const config = {\n            headers: {\n                ...axios.defaults.headers,\n                'content-type': 'multipart/form-data',\n            },\n        };\n        return axios.patch(url, formData, config);\n    };\n\n    isUserAuthenticated = () => {\n        const user = this.getLoggedInUser();\n        if (!user || (user && !user.token)) {\n            return false;\n        }\n        const decoded = jwtDecode(user.token);\n        const currentTime = Date.now() / 1000;\n        if (decoded.exp < currentTime) {\n            console.warn('access token expired');\n            return false;\n        } else {\n            return true;\n        }\n    };\n\n    setLoggedInUser = (session) => {\n        if (session) sessionStorage.setItem(AUTH_SESSION_KEY, JSON.stringify(session));\n        else {\n            sessionStorage.removeItem(AUTH_SESSION_KEY);\n        }\n    };\n\n    /**\n     * Returns the logged in user\n     */\n    getLoggedInUser = () => {\n        return getUserFromSession();\n    };\n\n    setUserInSession = (modifiedUser) => {\n        let userInfo = sessionStorage.getItem(AUTH_SESSION_KEY);\n        if (userInfo) {\n            const { token, user } = JSON.parse(userInfo);\n            this.setLoggedInUser({ token, ...user, ...modifiedUser });\n        }\n    };\n}\n\n/*\nCheck if token available in session\n*/\nlet user = getUserFromSession();\nif (user) {\n    const { token } = user;\n    if (token) {\n        setAuthorization(token);\n    }\n}\n\nexport { APICore, setAuthorization };\n"],"mappings":"qpBAAA,MAAOA,UAAP,KAAsB,YAAtB,CACA,MAAOC,MAAP,KAAkB,OAAlB,CAEA,MAAOC,OAAP,KAAmB,cAAnB,CAEA;AACAD,KAAK,CAACE,QAAN,CAAeC,OAAf,CAAuBC,IAAvB,CAA4B,cAA5B,EAA8C,kBAA9C,CACAJ,KAAK,CAACE,QAAN,CAAeG,OAAf,CAAyBJ,MAAM,CAACK,OAAhC,CAEA;AACAN,KAAK,CAACO,YAAN,CAAmBC,QAAnB,CAA4BC,GAA5B,CACI,SAACD,QAAD,CAAc,CACV,MAAOA,SAAP,CACH,CAHL,CAII,SAACE,KAAD,CAAW,CACP;AACA,GAAIC,QAAJ,CAEA,GAAID,KAAK,EAAIA,KAAK,CAACF,QAAf,EAA2BE,KAAK,CAACF,QAAN,CAAeI,MAAf,GAA0B,GAAzD,CAA8D,CAC1D;AACH,CAFD,IAEO,IAAIF,KAAK,EAAIA,KAAK,CAACF,QAAf,EAA2BE,KAAK,CAACF,QAAN,CAAeI,MAAf,GAA0B,GAAzD,CAA8D,CACjEC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,gBAAvB,CACH,CAFM,IAEA,CACH,OAAQL,KAAK,CAACF,QAAN,CAAeI,MAAvB,EACI,IAAK,IAAL,CACID,OAAO,CAAG,qBAAV,CACA,MACJ,IAAK,IAAL,CACIA,OAAO,CAAG,kBAAV,CACA,MACJ,IAAK,IAAL,CACIA,OAAO,CAAG,wDAAV,CACA,MACJ,QAAS,CACLA,OAAO,CACHD,KAAK,CAACF,QAAN,EAAkBE,KAAK,CAACF,QAAN,CAAeQ,IAAjC,CAAwCN,KAAK,CAACF,QAAN,CAAeQ,IAAf,CAAoB,SAApB,CAAxC,CAAyEN,KAAK,CAACC,OAAN,EAAiBD,KAD9F,CAEH,CAbL,CAeA,MAAOO,QAAO,CAACC,MAAR,CAAeP,OAAf,CAAP,CACH,CACJ,CA9BL,EAiCA,GAAMQ,iBAAgB,CAAG,YAAzB,CAEA;AACA;AACA;AACA,GACA,GAAMC,iBAAgB,CAAG,QAAnBA,iBAAmB,CAACC,KAAD,CAAW,CAChC,GAAIA,KAAJ,CAAWrB,KAAK,CAACE,QAAN,CAAeC,OAAf,CAAuBmB,MAAvB,CAA8B,eAA9B,EAAiD,OAASD,KAA1D,CAAX,IACK,OAAOrB,MAAK,CAACE,QAAN,CAAeC,OAAf,CAAuBmB,MAAvB,CAA8B,eAA9B,CAAP,CACR,CAHD,CAKA,GAAMC,mBAAkB,CAAG,QAArBA,mBAAqB,EAAM,CAC7B,GAAMC,KAAI,CAAGC,cAAc,CAACC,OAAf,CAAuBP,gBAAvB,CAAb,CACA,MAAOK,KAAI,CAAI,MAAOA,KAAP,EAAe,QAAf,CAA0BA,IAA1B,CAAiCG,IAAI,CAACC,KAAL,CAAWJ,IAAX,CAArC,CAAyD,IAApE,CACH,CAHD,C,GAIMK,Q,gGAIFC,G,CAAM,SAACC,GAAD,CAAMC,MAAN,CAAiB,CACnB,GAAIxB,SAAJ,CACA,GAAIwB,MAAJ,CAAY,CACR,GAAIC,YAAW,CAAGD,MAAM,CAClBE,MAAM,CAACC,IAAP,CAAYH,MAAZ,EACKI,GADL,CACS,SAACC,GAAD,QAASA,IAAG,CAAG,GAAN,CAAYL,MAAM,CAACK,GAAD,CAA3B,EADT,EAEKC,IAFL,CAEU,GAFV,CADkB,CAIlB,EAJN,CAKA9B,QAAQ,CAAGR,KAAK,CAAC8B,GAAN,WAAaC,GAAb,aAAoBE,WAApB,EAAmCD,MAAnC,CAAX,CACH,CAPD,IAOO,CACHxB,QAAQ,CAAGR,KAAK,CAAC8B,GAAN,WAAaC,GAAb,EAAoBC,MAApB,CAAX,CACH,CACD,MAAOxB,SAAP,CACH,C,MAED+B,O,CAAU,SAACR,GAAD,CAAMC,MAAN,CAAiB,CACvB,GAAIxB,SAAJ,CACA,GAAIwB,MAAJ,CAAY,CACR,GAAIC,YAAW,CAAGD,MAAM,CAClBE,MAAM,CAACC,IAAP,CAAYH,MAAZ,EACKI,GADL,CACS,SAACC,GAAD,QAASA,IAAG,CAAG,GAAN,CAAYL,MAAM,CAACK,GAAD,CAA3B,EADT,EAEKC,IAFL,CAEU,GAFV,CADkB,CAIlB,EAJN,CAKA9B,QAAQ,CAAGR,KAAK,CAAC8B,GAAN,WAAaC,GAAb,aAAoBE,WAApB,EAAmC,CAAEO,YAAY,CAAE,MAAhB,CAAnC,CAAX,CACH,CAPD,IAOO,CACHhC,QAAQ,CAAGR,KAAK,CAAC8B,GAAN,WAAaC,GAAb,EAAoB,CAAES,YAAY,CAAE,MAAhB,CAApB,CAAX,CACH,CACD,MAAOhC,SAAP,CACH,C,MAEDiC,W,CAAc,SAACC,IAAD,CAAOV,MAAP,CAAkB,CAC5B,GAAMW,KAAI,CAAG,EAAb,CACA,GAAIV,YAAW,CAAG,EAAlB,CACA,GAAID,MAAJ,CAAY,CACRC,WAAW,CAAGD,MAAM,CACdE,MAAM,CAACC,IAAP,CAAYH,MAAZ,EACKI,GADL,CACS,SAACC,GAAD,QAASA,IAAG,CAAG,GAAN,CAAYL,MAAM,CAACK,GAAD,CAA3B,EADT,EAEKC,IAFL,CAEU,GAFV,CADc,CAId,EAJN,CAKH,CAT2B,yCAWVI,IAXU,YAW5B,+CAAwB,IAAbX,IAAa,aACpBY,IAAI,CAACC,IAAL,CAAU5C,KAAK,CAAC8B,GAAN,WAAaC,GAAb,aAAoBE,WAApB,EAAV,EACH,CAb2B,qDAc5B,MAAOjC,MAAK,CAAC6C,GAAN,CAAUF,IAAV,CAAP,CACH,C,MAKDG,M,CAAS,SAACf,GAAD,CAAMf,IAAN,CAAe,CACpB,MAAOhB,MAAK,CAACI,IAAN,CAAW2B,GAAX,CAAgBf,IAAhB,CAAP,CACH,C,MAKD+B,W,CAAc,SAAChB,GAAD,CAAMf,IAAN,CAAe,CACzB,MAAOhB,MAAK,CAACgD,KAAN,CAAYjB,GAAZ,CAAiBf,IAAjB,CAAP,CACH,C,MAKDiC,M,CAAS,SAAClB,GAAD,CAAMf,IAAN,CAAe,CACpB,MAAOhB,MAAK,CAACkD,GAAN,CAAUnB,GAAV,CAAef,IAAf,CAAP,CACH,C,MAKDmC,M,CAAS,SAACpB,GAAD,CAAS,CACd,MAAO/B,MAAK,CAACmD,MAAN,CAAapB,GAAb,CAAP,CACH,C,MAKDqB,c,CAAiB,SAACrB,GAAD,CAAMf,IAAN,CAAe,CAC5B,GAAMqC,SAAQ,CAAG,GAAIC,SAAJ,EAAjB,CACA,IAAK,GAAMC,EAAX,GAAgBvC,KAAhB,CAAsB,CAClBqC,QAAQ,CAACG,MAAT,CAAgBD,CAAhB,CAAmBvC,IAAI,CAACuC,CAAD,CAAvB,EACH,CAED,GAAMtD,OAAM,CAAG,CACXE,OAAO,gCACAH,KAAK,CAACE,QAAN,CAAeC,OADf,MAEH,eAAgB,qBAFb,EADI,CAAf,CAMA,MAAOH,MAAK,CAACI,IAAN,CAAW2B,GAAX,CAAgBsB,QAAhB,CAA0BpD,MAA1B,CAAP,CACH,C,MAKDwD,c,CAAiB,SAAC1B,GAAD,CAAMf,IAAN,CAAe,CAC5B,GAAMqC,SAAQ,CAAG,GAAIC,SAAJ,EAAjB,CACA,IAAK,GAAMC,EAAX,GAAgBvC,KAAhB,CAAsB,CAClBqC,QAAQ,CAACG,MAAT,CAAgBD,CAAhB,CAAmBvC,IAAI,CAACuC,CAAD,CAAvB,EACH,CAED,GAAMtD,OAAM,CAAG,CACXE,OAAO,gCACAH,KAAK,CAACE,QAAN,CAAeC,OADf,MAEH,eAAgB,qBAFb,EADI,CAAf,CAMA,MAAOH,MAAK,CAACgD,KAAN,CAAYjB,GAAZ,CAAiBsB,QAAjB,CAA2BpD,MAA3B,CAAP,CACH,C,MAEDyD,mB,CAAsB,UAAM,CACxB,GAAMlC,KAAI,CAAG,KAAI,CAACmC,eAAL,EAAb,CACA,GAAI,CAACnC,IAAD,EAAUA,IAAI,EAAI,CAACA,IAAI,CAACH,KAA5B,CAAoC,CAChC,MAAO,MAAP,CACH,CACD,GAAMuC,QAAO,CAAG7D,SAAS,CAACyB,IAAI,CAACH,KAAN,CAAzB,CACA,GAAMwC,YAAW,CAAGC,IAAI,CAACC,GAAL,GAAa,IAAjC,CACA,GAAIH,OAAO,CAACI,GAAR,CAAcH,WAAlB,CAA+B,CAC3BI,OAAO,CAACC,IAAR,CAAa,sBAAb,EACA,MAAO,MAAP,CACH,CAHD,IAGO,CACH,MAAO,KAAP,CACH,CACJ,C,MAEDC,e,CAAkB,SAACC,OAAD,CAAa,CAC3B,GAAIA,OAAJ,CAAa3C,cAAc,CAAC4C,OAAf,CAAuBlD,gBAAvB,CAAyCQ,IAAI,CAAC2C,SAAL,CAAeF,OAAf,CAAzC,EAAb,IACK,CACD3C,cAAc,CAAC8C,UAAf,CAA0BpD,gBAA1B,EACH,CACJ,C,MAKDwC,e,CAAkB,UAAM,CACpB,MAAOpC,mBAAkB,EAAzB,CACH,C,MAEDiD,gB,CAAmB,SAACC,YAAD,CAAkB,CACjC,GAAIC,SAAQ,CAAGjD,cAAc,CAACC,OAAf,CAAuBP,gBAAvB,CAAf,CACA,GAAIuD,QAAJ,CAAc,CACV,gBAAwB/C,IAAI,CAACC,KAAL,CAAW8C,QAAX,CAAxB,CAAQrD,KAAR,aAAQA,KAAR,CAAeG,KAAf,aAAeA,IAAf,CACA,KAAI,CAAC2C,eAAL,8BAAuB9C,KAAK,CAALA,KAAvB,EAAiCG,KAAjC,EAA0CiD,YAA1C,GACH,CACJ,C,IAGL;AACA;AACA,EACA,GAAIjD,KAAI,CAAGD,kBAAkB,EAA7B,CACA,GAAIC,IAAJ,CAAU,CACN,GAAQH,MAAR,CAAkBG,IAAlB,CAAQH,KAAR,CACA,GAAIA,KAAJ,CAAW,CACPD,gBAAgB,CAACC,KAAD,CAAhB,CACH,CACJ,CAED,OAASQ,OAAT,CAAkBT,gBAAlB"},"metadata":{},"sourceType":"module"}